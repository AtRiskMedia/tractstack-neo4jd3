{"version":3,"file":"index.js","names":["d3","Neo4jD3","selector","_options","classes2colors","numClasses","nodes","relationships","options","colors","neo4jData","undefined","neo4jDataUrl","distance","strength","labelFontSize","infoPanel","VERSION","init","version","merge","target","source","Object","keys","forEach","property","toString","d","s","labels","type","id","properties","JSON","stringify","contains","array","filter","elem","length","linkArc","r","Math","hypot","x","y","linknum","drag","simulation","dragstarted","event","active","alphaTarget","restart","fx","fy","dragged","dragended","on","class2color","cls","color","_relationships","i","size","neo4jDataToD3Data","data","graph","results","result","node","push","relationship","startNode","startNodeId","endNode","endNodeId","sort","a","b","container","select","attr","html","svg","append","forceSimulation","force","forceManyBody","forceLink","random","forceCenter","parentElement","clientWidth","clientHeight","selectAll","join","relationshipArc","text","allNodes","enter","object_name","call"],"sources":["src/index.js"],"sourcesContent":["\"use strict\";\n\nimport * as d3 from \"d3\";\n\nexport default function Neo4jD3(selector, _options) {\n  var classes2colors = {},\n    numClasses = 0,\n    nodes,\n    relationships,\n    options = {\n      colors: colors(),\n      neo4jData: undefined,\n      neo4jDataUrl: undefined,\n      distance: 100,\n      strength: -300,\n      labelFontSize: \"9px\",\n      infoPanel: false,\n    },\n    VERSION = \"0.1.0\";\n\n  init(selector, _options);\n\n  function version() {\n    return VERSION;\n  }\n\n  function colors() {\n    // oneDark inspired by distrotube (dt)\n    return [\n      \"#5b6268\", // brighter black\n      \"#da8548\", // brighter red\n      \"#4db5bd\", // brighter green\n      \"#ecbe7b\", // brighter yellow\n      \"#3071db\", // brighter blue\n      \"#a9a1e1\", // brighter magenta\n      \"#46d9ff\", // brighter cyan\n      \"#dfdfdf\", // brighter white\n      \"#ff6c6b\", // red\n      \"#98be65\", // green\n      \"#da8548\", // yellow\n      \"#51afef\", // blue\n      \"#c678dd\", // magenta\n      \"#5699af\", // cyan\n      \"#a7b1b7\", // white\n      \"#1c1f24\", // black\n    ];\n  }\n\n  function merge(target, source) {\n    Object.keys(source).forEach(function (property) {\n      target[property] = source[property];\n    });\n  }\n\n  function toString(d) {\n    var s = d.labels ? d.labels[0] : d.type;\n\n    s += \" (<id>: \" + d.id;\n\n    Object.keys(d.properties).forEach(function (property) {\n      s += \", \" + property + \": \" + JSON.stringify(d.properties[property]);\n    });\n\n    s += \")\";\n\n    return s;\n  }\n\n  function contains(array, id) {\n    var filter = array.filter(function (elem) {\n      return elem.id === id;\n    });\n    return filter.length > 0;\n  }\n\n  function linkArc(d) {\n    const r =\n      (Math.hypot(d.target.x - d.source.x, d.target.y - d.source.y) /\n        d.linknum) *\n      2.5;\n    return `\n    M${d.source.x},${d.source.y}\n    A${r},${r} 0 0,1 ${d.target.x},${d.target.y}\n  `;\n  }\n\n  function drag(simulation) {\n    function dragstarted(event, d) {\n      if (!event.active) simulation.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    }\n    function dragged(event, d) {\n      d.fx = event.x;\n      d.fy = event.y;\n    }\n    function dragended(event, d) {\n      if (!event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    }\n    return d3\n      .drag()\n      .on(\"start\", dragstarted)\n      .on(\"drag\", dragged)\n      .on(\"end\", dragended);\n  }\n\n  function class2color(cls) {\n    var color = classes2colors[cls];\n    if (!color) {\n      //            color = options.colors[Math.min(numClasses, options.colors.length - 1)];\n      color = options.colors[numClasses % options.colors.length];\n      classes2colors[cls] = color;\n      numClasses++;\n    }\n    return color;\n  }\n\n  function _relationships(relationships) {\n    for (var i = 0; i < relationships.length; i++) {\n      if (\n        i != 0 &&\n        relationships[i].source == relationships[i - 1].source &&\n        relationships[i].target == relationships[i - 1].target\n      ) {\n        relationships[i].linknum = relationships[i - 1].linknum + 1;\n      } else {\n        relationships[i].linknum = 1;\n      }\n    }\n    return relationships;\n  }\n\n  function size() {\n    return {\n      nodes: nodes.length,\n      relationships: relationships.length,\n    };\n  }\n\n  function neo4jDataToD3Data(data) {\n    var graph = {\n      nodes: [],\n      relationships: [],\n    };\n    data?.results?.forEach(function (result) {\n      result.data.forEach(function (data) {\n        data.graph.nodes.forEach(function (node) {\n          if (!contains(graph.nodes, node.id)) {\n            graph.nodes.push(node);\n          }\n        });\n        data.graph.relationships.forEach(function (relationship) {\n          relationship.source =\n            relationship.startNode | relationship.startNodeId;\n          relationship.target = relationship.endNode | relationship.endNodeId;\n          graph.relationships.push(relationship);\n        });\n        data.graph.relationships.sort(function (a, b) {\n          if (a.source > b.source) {\n            return 1;\n          } else if (a.source < b.source) {\n            return -1;\n          } else {\n            if (a.target > b.target) {\n              return 1;\n            }\n            if (a.target < b.target) {\n              return -1;\n            } else {\n              return 0;\n            }\n          }\n        });\n        for (var i = 0; i < data.graph.relationships.length; i++) {\n          if (\n            i !== 0 &&\n            data.graph.relationships[i].source ===\n              data.graph.relationships[i - 1].source &&\n            data.graph.relationships[i].target ===\n              data.graph.relationships[i - 1].target\n          ) {\n            data.graph.relationships[i].linknum =\n              data.graph.relationships[i - 1].linknum + 1;\n          } else {\n            data.graph.relationships[i].linknum = 1;\n          }\n        }\n      });\n    });\n    return graph;\n  }\n\n  function init(selector, _options) {\n    merge(options, _options);\n    if (options && options?.neo4jData) {\n      const data = neo4jDataToD3Data(options.neo4jData);\n      const container = d3.select(selector);\n      container.attr(\"class\", \"neo4jd3\").html(\"\");\n      const relationships = _relationships(data.relationships);\n      const nodes = data.nodes;\n      const svg = container\n        .append(\"svg\")\n        .attr(\"width\", \"100%\")\n        .attr(\"height\", \"100%\")\n        .attr(\"class\", \"neo4jd3-graph\");\n      const simulation = d3\n        .forceSimulation(nodes)\n        .force(\"charge\", d3.forceManyBody().strength(options.strength))\n        .force(\n          \"link\",\n          d3\n            .forceLink(relationships)\n            .id(function (d) {\n              return d?.id;\n            })\n            .distance(function () {\n              return (\n                (options?.distance | 100) +\n                (options?.distance | 100) * 0.25 * Math.random()\n              );\n            })\n        )\n        .force(\n          \"center\",\n          d3.forceCenter(\n            svg.node().parentElement.parentElement.clientWidth / 2,\n            svg.node().parentElement.parentElement.clientHeight / 2\n          )\n        );\n      svg\n        .append(\"g\")\n        .attr(\"class\", \"relationships\")\n        .attr(\"fill\", \"none\")\n        .attr(\"stroke-width\", 4)\n        .selectAll(\"g\")\n        .data(relationships, function (d) {\n          return d.id;\n        })\n        .join(\"g\")\n        .attr(\"class\", \"relationship\");\n      const relationshipArc = svg\n        .selectAll(\".relationship\")\n        .append(\"path\")\n        .attr(\"id\", function (d, i) {\n          return \"edgepath\" + i;\n        })\n        .join(\"path\")\n        .attr(\"stroke\", (d) => class2color(d.type));\n      svg\n        .selectAll(\".relationship\")\n        .append(\"text\")\n        .attr(\"class\", \"text\")\n        .attr(\"fill\", \"#000\")\n        .attr(\"font-size\", options.labelFontSize)\n        .attr(\"class\", \"text\")\n        .append(\"textPath\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"startOffset\", \"50%\")\n        .attr(\"xlink:xlink:href\", function (d, i) {\n          return \"#edgepath\" + i;\n        })\n        .text(function (d) {\n          return d.type;\n        });\n      const allNodes = svg\n        .append(\"g\")\n        .attr(\"class\", \"nodes\")\n        .attr(\"fill\", \"currentColor\")\n        .attr(\"class\", \"node\")\n        .attr(\"stroke-linecap\", \"round\")\n        .attr(\"stroke-linejoin\", \"round\")\n        .attr(\"cursor\", \"pointer\")\n        .selectAll(\"g\")\n        .data(nodes, function (d) {\n          return d.id;\n        })\n        .join(\"g\")\n        .attr(\"class\", \"node\")\n        .selectAll(\"text\")\n        .data(nodes)\n        .enter()\n        .append(\"text\")\n        .attr(\"dx\", 12)\n        .attr(\"dy\", \".35em\")\n        .text(function (d) {\n          return typeof d?.properties?.object_name === \"string\"\n            ? d.properties.object_name\n            : d?.labels && d?.labels[0] && typeof d?.labels[0] === \"string\"\n            ? d.labels[0]\n            : \"*\";\n        })\n        .call(drag(simulation));\n      allNodes\n        .append(\"circle\")\n        .attr(\"stroke\", \"#000\")\n        .attr(\"stroke-width\", 1)\n        .attr(\"fill\", (d) => class2color(d.labels[0]))\n        .attr(\"r\", 7)\n        .append(\"title\")\n        .text(function (d) {\n          return toString(d);\n        });\n      simulation.on(\"tick\", function () {\n        relationshipArc.attr(\"d\", linkArc);\n        allNodes.attr(\"transform\", (d) => `translate(${d.x},${d.y})`);\n      });\n    }\n  }\n\n  return {\n    neo4jDataToD3Data: neo4jDataToD3Data,\n    size: size,\n    version: version,\n  };\n}\n"],"mappings":"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"}